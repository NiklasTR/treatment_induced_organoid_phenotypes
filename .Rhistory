geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor2") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor3") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor4") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor5") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor6") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor4") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor3") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor5))
ranks <- setNames(df$factor5, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor1))
ranks <- setNames(df$factor1, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor2))
ranks <- setNames(df$factor2, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor3))
ranks <- setNames(df$factor3, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
ranks <- setNames(df$factor4, as.character(df$entrez))
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor4))
ranks <- setNames(df$factor4, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
df %>%
filter(number == "factor4") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
set.seed(123)
df <- umap_tidy %>%
group_by(drug) %>%
sample_n(100) %>%
left_join(weights_single_conc %>% dplyr::select(-conc_nan)) %>%
dplyr::select(v1, v2, contains("factor"), -size_factor) %>% pivot_longer(cols = contains("factor"), names_to = "number", values_to = "value") %>%
drop_na()
df %>%
filter(number == "factor4") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor6") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
filter(number == "factor7
df %>%
filter(number == "factor7") %>%
df %>%
filter(number == "factor7") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor7") %>%
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor8") %>% # 7-11
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor9") %>% # 7-11
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor9))
ranks <- setNames(df$factor9, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor10))
ranks <- setNames(df$factor10, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor12))
ranks <- setNames(df$factor12, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor5))
ranks <- setNames(df$factor5, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor6))
ranks <- setNames(df$factor6, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
df %>%
filter(number == "factor6") %>% # 7-11
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
set.seed(123)
df <- umap_tidy %>%
group_by(drug) %>%
sample_n(100) %>%
left_join(weights_single_conc %>% dplyr::select(-conc_nan)) %>%
dplyr::select(v1, v2, contains("factor"), -size_factor) %>% pivot_longer(cols = contains("factor"), names_to = "number", values_to = "value") %>%
drop_na()
df %>%
filter(number == "factor6") %>% # 7-11
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor7))
ranks <- setNames(df$factor7, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
set.seed(123)
df <- umap_tidy %>%
group_by(drug) %>%
sample_n(100) %>%
left_join(weights_single_conc %>% dplyr::select(-conc_nan)) %>%
dplyr::select(v1, v2, contains("factor"), -size_factor) %>% pivot_longer(cols = contains("factor"), names_to = "number", values_to = "value") %>%
drop_na()
df %>%
filter(number == "factor7") %>% # 7-11
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df <- loadings_expression %>%
separate(id, c("symbol"), sep = "_exp") %>%
left_join(promise_expr %>% dplyr::select(symbol, entrez) %>% distinct()) %>%
arrange(desc(factor8))
ranks <- setNames(df$factor8, as.character(df$entrez))
ranks <- sort(ranks, decreasing = T)
## Reactome enrichment analysis
gse_reactome <- gsePathway(
geneList = ranks,
organism = 'human',
#nPerm = 1e5,
minGSSize = 50,
maxGSSize = 500
)
emapplot(gse_reactome, color = "NES")
set.seed(123)
df <- umap_tidy %>%
group_by(drug) %>%
sample_n(100) %>%
left_join(weights_single_conc %>% dplyr::select(-conc_nan)) %>%
dplyr::select(v1, v2, contains("factor"), -size_factor) %>% pivot_longer(cols = contains("factor"), names_to = "number", values_to = "value") %>%
drop_na()
df %>%
filter(number == "factor8") %>% # 7-11
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
set.seed(123)
df <- umap_tidy %>%
group_by(drug) %>%
sample_n(100) %>%
left_join(weights_single_conc %>% dplyr::select(-conc_nan)) %>%
dplyr::select(v1, v2, contains("factor"), -size_factor) %>% pivot_longer(cols = contains("factor"), names_to = "number", values_to = "value") %>%
drop_na()
df %>%
filter(number == "factor4") %>% # 7-11
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor5") %>% # 7-11
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
df %>%
filter(number == "factor4") %>% # 7-11
ggplot(aes(v1, v2, color = value)) +
geom_point_rast(alpha = 0.5, size = 0.35) +
scale_color_viridis_c() +
theme_cowplot() +
labs(x = "UMAP 1",
y = "UMAP 2",
color = "partition") +
facet_wrap(~ number) +
theme(legend.position = "bottom") +
coord_fixed()
weights_single_conc
weights_single_conc_umap <- weights_single_conc %>%
uwot::umap()
weights_single_conc_umap
cbind(weights_single_conc_umap, weights_single_conc)
cbind(weights_single_conc_umap, weights_single_conc)
cbind(weights_single_conc_umap, weights_single_conc) %>% janitor::clean_names()
df <- cbind(weights_single_conc_umap, weights_single_conc) %>% janitor::clean_names()
df %>%
ggplot(aes(x1, x2)) +
geom_point()
df %>%
ggplot(aes(x1, x2, fill = line)) +
geom_point()
df %>%
ggplot(aes(x1, x2, color = line)) +
geom_point()
reticulate::repl_python()
install.packages('ggrastr')
ggrastr
library(ggraster)
